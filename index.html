<script>
const divisions = {
  "World East": {
    logo: "https://res.cloudinary.com/de4q4iitx/image/upload/v1752231585/world-east_dzwpw9.png",
    teams: [
      ["Australia Whites", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182184/australia-whites_h9o2vz.png"],
      ["Italia Bulls", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/italia-bulls_aocvis.png"],
      ["Belarus Barbarians", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/belarus-barbarians_ydx3kz.png"],
      ["Singapore Smelters", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182186/singapore-smelters_qn3ges.png"],
      ["South Korea Deers", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182186/southkorea-deers_jbt02f.png"],
      ["Poland Panthers", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182186/poland-panthers_ppg3zr.png"]
    ]
  },
  "World Central": {
    logo: "https://res.cloudinary.com/de4q4iitx/image/upload/v1752231585/world-central_okus8o.png",
    teams: [
      ["Germany Cavaliers", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/germany-cavaliers_qrcojc.png"],
      ["UK 3 Lions", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182186/uk-tri-lions_kyixfr.png"],
      ["Finland Frigate", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/finland-frigate_u7rjbj.png"],
      ["Belgium Bulldogs", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/belgium-bulldogs_hrx8td.png"],
      ["Holland Hornets", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/holland-hornets_ilzroo.png"],
      ["South Africa Silverbacks", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182186/southafrica-silverbaks_x6but2.png"]
    ]
  },
  "World West": {
    logo: "https://res.cloudinary.com/de4q4iitx/image/upload/v1752231585/world-west_ie8gga.png",
    teams: [
      ["USA Drones", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182187/usa-drones_doeba8.png"],
      ["Jamaica Thunder", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/jamaica-thunder_ogo7aj.png"],
      ["Rwanda Raiders", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182186/rwanda-raiders_aqtgu7.png"],
      ["Egypt Pharaohs", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/egypt-pharaohs_ycglpl.png"],
      ["Peru Piranhas", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/peru-piranhas_yueas6.png"],
      ["Brazil Hummingbirds", "https://res.cloudinary.com/de4q4iitx/image/upload/v1752182185/brazil-hummingbirds_dras9r.png"]
    ]
  }
};

let divisionWinners = {};
let wildcardSelections = [];

const divisionsContainer = document.getElementById("divisions");
const toWildcardsBtn = document.getElementById("toWildcards");
const backBtn = document.getElementById("backToStage1");
const wildcardsGrid = document.getElementById("wildcards");

function renderDivisions() {
  divisionsContainer.innerHTML = '';
  for (const [divisionName, data] of Object.entries(divisions)) {
    const division = document.createElement("div");
    division.className = "division";
    division.innerHTML = `
      <h2><img src="${data.logo}" class="logo">${divisionName}</h2>
      <div class="team-grid" id="${divisionName.replaceAll(' ', '-')}-grid"></div>
    `;
    const grid = division.querySelector('.team-grid');
    data.teams.forEach(([teamName, logo]) => {
      const card = document.createElement("div");
      card.className = "team-card";
      card.innerHTML = `<img src="${logo}"><span>${teamName}</span>`;
      card.onclick = () => {
        if (divisionWinners[divisionName] === teamName) {
          delete divisionWinners[divisionName];
        } else {
          divisionWinners[divisionName] = teamName;
        }
        updateSelections();
      };
      card.dataset.team = teamName;
      grid.appendChild(card);
    });
    divisionsContainer.appendChild(division);
  }
}

function updateSelections() {
  document.querySelectorAll(".team-card").forEach(card => {
    card.classList.remove("selected", "disabled");
  });

  for (const [divisionName, data] of Object.entries(divisions)) {
    const selected = divisionWinners[divisionName];
    const grid = document.getElementById(`${divisionName.replaceAll(' ', '-')}-grid`);
    const cards = grid.querySelectorAll(".team-card");
    cards.forEach(card => {
      if (card.dataset.team === selected) {
        card.classList.add("selected");
      } else if (selected) {
        card.classList.add("disabled");
      }
    });
  }

  toWildcardsBtn.disabled = Object.keys(divisionWinners).length !== 3;
}

function goToStage2() {
  document.getElementById("stage1").classList.remove("active");
  document.getElementById("stage2").classList.add("active");

  const allTeams = Object.entries(divisions).flatMap(([divisionName, data]) =>
    data.teams.filter(([name]) => divisionWinners[divisionName] !== name)
  );

  wildcardsGrid.innerHTML = '';
  allTeams.forEach(([teamName, logo]) => {
    const card = document.createElement("div");
    card.className = "team-card";
    card.innerHTML = `<img src="${logo}"><span>${teamName}</span>`;
    card.onclick = () => {
      if (wildcardSelections.includes(teamName)) {
        wildcardSelections = wildcardSelections.filter(t => t !== teamName);
      } else if (wildcardSelections.length < 5) {
        wildcardSelections.push(teamName);
      }
      updateWildcardUI();
    };
    card.dataset.team = teamName;
    wildcardsGrid.appendChild(card);
  });
  updateWildcardUI();
}

function updateWildcardUI() {
  wildcardsGrid.querySelectorAll(".team-card").forEach(card => {
    const team = card.dataset.team;
    card.classList.remove("selected");
    if (wildcardSelections.includes(team)) {
      card.classList.add("selected");
    }
  });
}

toWildcardsBtn.onclick = goToStage2;
backBtn.onclick = () => {
  document.getElementById("stage2").classList.remove("active");
  document.getElementById("stage1").classList.add("active");
  wildcardSelections = [];
  updateSelections();
};

renderDivisions();
</script>
</body>
</html>
